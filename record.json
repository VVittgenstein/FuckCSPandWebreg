{
  "project_context": {
    "brief": "构建一个基于 Rutgers SOC 公开数据的选课查询与空位提醒网站，在“浏览/筛选课程 + 订阅空位提醒”场景下替代 CSP 和 WebReg 的日常使用体验，同时保持低运营成本与开源可一键部署能力。",
    "mvp_goal": "在每个部署环境内运行本地 SQLite 数据库 + 轻量 API 服务 + 前端 UI，实现针对多学期与多校区课程的浏览、多维筛选与邮箱/Discord 空位提醒闭环，并保持低运营成本与可在个人电脑/服务器一键部署。",
    "non_goals": [
      "不接入 WebReg 或任何需要登录的系统页面，不在本项目中执行自动选课/退课操作。",
      "不实现完整的学位规划、毕业审核或复杂先修关系校验，仅在 UI 展示先修与核心课程标签。",
      "不处理除邮箱地址与 Discord 标识之外的用户敏感信息，也不构建账号/登录体系。",
      "不承担对 Rutgers 官方课程与容量信息的权威解释责任，数据以官方 SOC 为准。",
      "MVP 不支持短信等额外通知渠道，仅聚焦邮箱和 Discord。",
      "MVP 不强求覆盖全部校区与研究生课程，具体范围后续确认。"
    ]
  },
  "md_source": "2025-11-11-dr.md",
  "generated_at": "2025-11-13T00:00:00Z",
  "tasks": {
    "T-20251113-soc-api-validation": {
      "seed_id": null,
      "title": "验证 Rutgers SOC API 参数、限流与字段行为",
      "type": "research",
      "summary": "围绕 C2、R-20251113-soc-api-change 与开放问题 Q-01，对 Rutgers SOC API 的参数组合、拉取全校课程的策略、速率限制与返回字段进行实测，产出可复用的调用指南，降低后续抓取脚本与通知轮询的风险。",
      "acceptance_draft": [
        "整理出在多学期、多校区场景下获取全部课程的推荐调用策略（例如按 term + campus / subject 分批），并估算完整抓取一次全量以及常规增量更新所需时间。",
        "记录 SOC API 的关键参数与典型响应样例，确认字段覆盖 FR-01/FR-02 所需信息，并标记可能缺失或不稳定的字段。",
        "通过高频调用实验观察速率限制与错误码，给出可接受的最大抓取与轮询频率建议，并形成一份内部说明文档。"
      ],
      "lane": "now",
      "priority_suggested": "P0",
      "status": "todo",
      "dependencies": [],
      "blocked": true,
      "blocked_by": [
        {
          "dep_id": "DEP-001",
          "name": "Rutgers SOC API（courses.json / openSections）",
          "type": "api",
          "status": "unknown",
          "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
          "note": "需要在开发前期通过实测确认可用参数、速率限制和结构稳定性。"
        }
      ],
      "unblock_plan": "在测试环境以较低频率尝试多种参数组合，逐步提高频率观察限流行为，将结果记录到 docs/soc_api_notes 中并同步到抓取脚本与通知配置。",
      "estimate_h": 4,
      "risk": "high",
      "confidence": 0.65,
      "interfaces_touched": [
        "data-source",
        "observability"
      ],
      "artifacts": [
        "docs/soc_api_notes.md"
      ],
      "citations": [
        "EVID-001",
        "EVID-002",
        "R-20251113-soc-api-change",
        "Q-01"
      ],
      "created_at": "2025-11-13T00:00:00Z",
      "updated_at": "2025-11-13T00:00:00Z",
      "owner": "tbd",
      "tags": [
        "research",
        "soc-api"
      ],
      "subtasks": {
        "T-20251113-soc-api-validation-ST-01": {
          "seed_id": null,
          "title": "构建 SOC API 探测脚本",
          "type": "coding",
          "summary": "实现一个 Node 脚本批量访问 courses/sections/openSections 资源，枚举 term 与 campus 组合并将原始响应与指标落盘，为后续抓取脚本提供真实样本。",
          "acceptance_draft": [
            "scripts/soc/probe_endpoints.ts 支持至少 3 个 term × 3 个 campus 组合，依次访问 courses、sections、openSections 并将响应写入 data/probes/<term>-<campus>-<resource>.json。",
            "脚本同时记录每次调用的状态码、耗时与 payload 大小，写入 CSV data/probes/latency.csv 并提供累计汇总。",
            "在 docs/soc_api/probe_usage.md 增加使用说明与示例输出，确保任何人都可本地复现样本抓取。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [],
          "blocked": true,
          "blocked_by": [
            {
              "dep_id": "DEP-001",
              "name": "Rutgers SOC API（courses.json / openSections）",
              "type": "api",
              "status": "unknown",
              "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
              "note": "需要在开发前期通过实测确认可用参数、速率限制和结构稳定性。"
            }
          ],
          "unblock_plan": "在可访问窗口内跑脚本，设置节流系数避免触发限流，并将数据样本与日志提交到仓库 data/probes。",
          "estimate_h": 3,
          "risk": "mid",
          "confidence": 0.62,
          "interfaces_touched": [
            "data-source",
            "scripts",
            "docs"
          ],
          "artifacts": [
            "scripts/soc/probe_endpoints.ts",
            "data/probes/",
            "docs/soc_api/probe_usage.md"
          ],
          "citations": [
            "EVID-001",
            "EVID-002",
            "R-20251113-soc-api-change",
            "Q-01"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "soc-api",
            "automation"
          ]
        },
        "T-20251113-soc-api-validation-ST-02": {
          "seed_id": null,
          "title": "跑限流与容错实测",
          "type": "research",
          "summary": "编写速率实验脚本，在受控环境下逐步提升调用并记录 Rutgers SOC API 的限流阈值、错误码与恢复时间，为轮询与抓取设定硬指标。",
          "acceptance_draft": [
            "scripts/soc/rate_tester.ts 能设置并发/间隔参数，自动构造 term/campus/subject 调用矩阵，输出 data/probes/rate-limits.json，记录每秒请求数与返回码。",
            "实验结果整理到 docs/soc_api/limits.md，包含触发限流前的最大安全速率、常见错误码及恢复观察。",
            "提供 npm script（如 npm run test:soc-rate）可一键复现实验，失败时返回非 0 并输出日志。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [],
          "blocked": true,
          "blocked_by": [
            {
              "dep_id": "DEP-001",
              "name": "Rutgers SOC API（courses.json / openSections）",
              "type": "api",
              "status": "unknown",
              "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
              "note": "需要在开发前期通过实测确认可用参数、速率限制和结构稳定性。"
            }
          ],
          "unblock_plan": "利用 probe 数据中的参数组合，在夜间或低频时段执行速率脚本，并通过 sleep/backoff 控制防止被封锁。",
          "estimate_h": 4,
          "risk": "high",
          "confidence": 0.55,
          "interfaces_touched": [
            "data-source",
            "observability",
            "scripts"
          ],
          "artifacts": [
            "scripts/soc/rate_tester.ts",
            "data/probes/rate-limits.json",
            "docs/soc_api/limits.md"
          ],
          "citations": [
            "EVID-001",
            "EVID-002",
            "R-20251113-soc-api-change",
            "Q-01"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "soc-api",
            "validation"
          ]
        },
        "T-20251113-soc-api-validation-ST-03": {
          "seed_id": null,
          "title": "生成机器可用的参数配置",
          "type": "coding",
          "summary": "解析采集到的样本响应，自动产出 config/soc_endpoints.json，列举资源/参数/字段映射，并提供 TS 类型供抓取脚本复用。",
          "acceptance_draft": [
            "scripts/soc/build_endpoint_config.ts 读取 data/probes/* 样本，统计每个资源的必填与可选参数、字段层级，并将结构输出为 config/soc_endpoints.json。",
            "生成 docs/soc_api/field_map.md，包含字段含义、样例值与“是否稳定出现”的统计。",
            "新增 tests/soc/endpoint_config.test.ts 校验关键字段存在且与样本一致，防止未来回归。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [],
          "blocked": true,
          "blocked_by": [
            {
              "dep_id": "DEP-001",
              "name": "Rutgers SOC API（courses.json / openSections）",
              "type": "api",
              "status": "unknown",
              "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
              "note": "需要在开发前期通过实测确认可用参数、速率限制和结构稳定性。"
            }
          ],
          "unblock_plan": "在样本与限流结果齐备后运行解析脚本，人工 spot check 重点字段再提交配置与文档。",
          "estimate_h": 3,
          "risk": "mid",
          "confidence": 0.6,
          "interfaces_touched": [
            "data-source",
            "build-script",
            "docs"
          ],
          "artifacts": [
            "scripts/soc/build_endpoint_config.ts",
            "config/soc_endpoints.json",
            "docs/soc_api/field_map.md",
            "tests/soc/endpoint_config.test.ts"
          ],
          "citations": [
            "EVID-001",
            "EVID-002",
            "R-20251113-soc-api-change",
            "Q-01"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "soc-api",
            "data-model"
          ]
        }
      }
    },
    "T-20251113-act-001-soc-json-scraper": {
      "seed_id": "ACT-001",
      "title": "封装 Rutgers SOC 数据抓取与本地数据库初始化脚本",
      "type": "coding",
      "summary": "基于 D-20251113-data-source-soc，从 Rutgers SOC 接口按学期与校区批量抓取课程与 Section，使用事务将结果写入本地 SQLite 数据库，为查询 API 与通知进程提供统一数据源，并验证字段覆盖 FR-01/FR-02。",
      "acceptance_draft": [
        "脚本支持以 term + campus 为输入，或接收 term/campus 列表批量处理，针对每个组合调用 SOC API 并将课程/Section 写入 SQLite 数据库（事务 + 幂等 upsert），失败时提供重试与清晰错误日志。",
        "数据库中的 courses/sections 等表字段覆盖 FR-01/FR-02 中列出的关键字段（课程标题、代码、学分、院系、Index、Section、时间地点、核心代码、先修、授课模式等），随机抽样 ≥10 门课与官方 SOC 页面比对值一致。",
        "脚本输出更新摘要（新增/更新/删除条数、学期/校区范围），支持“全量初始化”和“增量更新”两种模式，增量模式仅替换状态发生变化的记录。"
      ],
      "lane": "now",
      "priority_suggested": "P0",
      "status": "todo",
      "dependencies": [
        "T-20251113-act-007-local-db-schema"
      ],
      "blocked": true,
      "blocked_by": [
        {
          "dep_id": "DEP-001",
          "name": "Rutgers SOC API（courses.json / openSections）",
          "type": "api",
          "status": "unknown",
          "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
          "note": "接口无正式公开文档，速率限制与长期稳定性未知；结构或访问策略变更将直接影响数据抓取与通知准确性。"
        }
      ],
      "unblock_plan": "先完成 T-20251113-soc-api-validation 与 T-20251113-act-007-local-db-schema，锁定字段/索引定义后再实现写入与增量更新逻辑，并在 CI 中加入数据库一致性校验。",
      "estimate_h": 6,
      "risk": "high",
      "confidence": 0.7,
      "interfaces_touched": [
        "data-source",
        "database",
        "build-script"
      ],
      "artifacts": [
        "scripts/fetch_soc_data.ts",
        "data/courses.sqlite"
      ],
      "citations": [
        "EVID-001",
        "EVID-002",
        "R-20251113-soc-api-change",
        "#md-4-1-fr-01"
      ],
      "created_at": "2025-11-13T00:00:00Z",
      "updated_at": "2025-11-13T00:00:00Z",
      "owner": "tbd",
      "tags": [
        "seed:ACT-001",
        "backend",
        "soc-api",
        "data-pipeline"
      ],
      "subtasks": {
        "T-20251113-act-001-soc-json-scraper-ST-01": {
          "seed_id": null,
          "title": "实现 SOC API 客户端模块",
          "type": "coding",
          "summary": "在 src/lib 中构建强类型 SOCClient，封装认证、重试、节流与日志，供抓取与轮询脚本共享。",
          "acceptance_draft": [
            "src/lib/socClient.ts 暴露 getCourses/getSections/getOpenSections 等方法，支持 term/campus/subject 参数与指数退避重试。",
            "使用 dotenv 或 config/soc.json 管理 base URL 与速率设置，错误时输出结构化日志。",
            "tests/socClient.test.ts 使用 nock/fixture 覆盖成功、节流、失败重试三类场景，覆盖率 ≥ 80%。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [],
          "blocked": true,
          "blocked_by": [
            {
              "dep_id": "DEP-001",
              "name": "Rutgers SOC API（courses.json / openSections）",
              "type": "api",
              "status": "unknown",
              "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
              "note": "接口无正式公开文档，速率限制与长期稳定性未知；结构或访问策略变更将直接影响数据抓取与通知准确性。"
            }
          ],
          "unblock_plan": "以验证阶段生成的 config/soc_endpoints.json 为输入，实现 TypeScript 类型并封装重试。",
          "estimate_h": 4,
          "risk": "mid",
          "confidence": 0.63,
          "interfaces_touched": [
            "backend",
            "data-source"
          ],
          "artifacts": [
            "src/lib/socClient.ts",
            "config/soc.json",
            "tests/socClient.test.ts"
          ],
          "citations": [
            "EVID-001",
            "EVID-002",
            "R-20251113-soc-api-change",
            "#md-4-1-fr-01"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "soc-api",
            "sdk"
          ]
        },
        "T-20251113-act-001-soc-json-scraper-ST-02": {
          "seed_id": null,
          "title": "编写原始数据抓取 CLI",
          "type": "coding",
          "summary": "提供 scripts/jobs/fetch_soc_data.ts CLI，可按 term+campus 列表批量抓取并落盘 data/raw JSON 快照，支持断点续跑。",
          "acceptance_draft": [
            "CLI 接收 --terms、--campuses、--subjects 等参数，默认读取 config/fetch_targets.json 并串行/并行批量处理。",
            "抓取结果按 data/raw/<term>/<campus>/<resource>.json 组织，并写入 data/raw/manifest.json 记录哈希/行数/抓取时间。",
            "命令运行失败时退出非 0，并提供 --resume 选项可只补抓失败批次；README 中新增使用示例。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-001-soc-json-scraper-ST-01"
          ],
          "blocked": true,
          "blocked_by": [
            {
              "dep_id": "DEP-001",
              "name": "Rutgers SOC API（courses.json / openSections）",
              "type": "api",
              "status": "unknown",
              "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
              "note": "接口无正式公开文档，速率限制与长期稳定性未知；结构或访问策略变更将直接影响数据抓取与通知准确性。"
            }
          ],
          "unblock_plan": "复用 SOCClient，利用限流实验中的安全速率配置 CLI，优先实现存档结构再补充并发。",
          "estimate_h": 5,
          "risk": "mid",
          "confidence": 0.58,
          "interfaces_touched": [
            "data-source",
            "build-script",
            "ops"
          ],
          "artifacts": [
            "scripts/jobs/fetch_soc_data.ts",
            "config/fetch_targets.json",
            "data/raw/manifest.json"
          ],
          "citations": [
            "EVID-001",
            "EVID-002",
            "R-20251113-soc-api-change",
            "#md-4-1-fr-01"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "data-pipeline",
            "cli"
          ]
        },
        "T-20251113-act-001-soc-json-scraper-ST-03": {
          "seed_id": null,
          "title": "实现 SQLite 入库脚本",
          "type": "coding",
          "summary": "把 data/raw JSON 写入本地 SQLite，包含幂等 upsert、事务包裹与抓取摘要输出。",
          "acceptance_draft": [
            "scripts/jobs/import_soc_data.ts 读取 manifest，使用批量事务写入 db/courses.sqlite，各表 upsert 以 term+campus+courseNumber 为键。",
            "脚本执行后输出新增/更新/删除条数，并生成 data/import_logs/<timestamp>.log，失败会回滚事务。",
            "tests/import_soc_data.test.ts 在 sqlite-temp DB 跑集成测试，验证重复运行不会破坏既有记录。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-001-soc-json-scraper-ST-02",
            "T-20251113-act-007-local-db-schema"
          ],
          "blocked": true,
          "blocked_by": [
            {
              "dep_id": "DEP-001",
              "name": "Rutgers SOC API（courses.json / openSections）",
              "type": "api",
              "status": "unknown",
              "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
              "note": "接口无正式公开文档，速率限制与长期稳定性未知；结构或访问策略变更将直接影响数据抓取与通知准确性。"
            }
          ],
          "unblock_plan": "等待 schema 与原始数据样本稳定后实施，将脚本纳入 npm scripts 方便 CI/本地执行。",
          "estimate_h": 5,
          "risk": "mid",
          "confidence": 0.55,
          "interfaces_touched": [
            "database",
            "data-pipeline"
          ],
          "artifacts": [
            "scripts/jobs/import_soc_data.ts",
            "data/import_logs/",
            "tests/import_soc_data.test.ts"
          ],
          "citations": [
            "EVID-001",
            "EVID-002",
            "R-20251113-soc-api-change",
            "#md-4-1-fr-01"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "database",
            "automation"
          ]
        }
      }
    },
    "T-20251113-act-002-frontend-filter-mvp": {
      "seed_id": "ACT-002",
      "title": "实现基于本地查询 API 的课程列表与多维筛选（MVP）",
      "type": "coding",
      "summary": "前端 SPA 不再一次性加载全部课程 JSON，而是通过本地查询 API 按需请求课程/Section 数据，提供与 FR-01/FR-02/FR-03 对齐的多维筛选、周视图及分页体验，确保 UI 与数据库保持一致。",
      "acceptance_draft": [
        "用户选择 term + campus 后，前端调用本地 API 拉取分页课程/Section 数据并展示完整字段，随机抽样 ≥10 门课核对与 SOC 数据库存储一致。",
        "筛选 UI 支持标题/代码关键字、学分、院系、课程层次、先修、核心代码、Index/Section、教师、状态、星期/时间区间、校区/教学楼/教室、授课模式等字段的单条件与多条件组合，前端会将条件映射为 API 查询参数并保证结果一致。",
        "在约 4500 门课程（含 1 万+ Section）的数据量下，常见筛选、分页与视图切换的“API 往返 + 前端渲染”整体响应 < 0.5 秒；当本地 API 不可用时给出明确的错误提示。"
      ],
      "lane": "now",
      "priority_suggested": "P0",
      "status": "todo",
      "dependencies": [
        "T-20251113-act-001-soc-json-scraper",
        "T-20251113-act-008-local-query-api"
      ],
      "blocked": false,
      "blocked_by": [],
      "unblock_plan": "",
      "estimate_h": 8,
      "risk": "mid",
      "confidence": 0.7,
      "interfaces_touched": [
        "frontend",
        "api-client",
        "filter-logic",
        "calendar-view"
      ],
      "artifacts": [
        "src/pages/courses.tsx",
        "src/components/filters/*",
        "src/components/calendar-view/*",
        "src/api/hooks/useCourses.ts"
      ],
      "citations": [
        "EVID-001",
        "EVID-002",
        "EVID-006",
        "R-20251113-frontend-perf",
        "D-20251113-arch-static-frontend-b"
      ],
      "created_at": "2025-11-13T00:00:00Z",
      "updated_at": "2025-11-13T00:00:00Z",
      "owner": "tbd",
      "tags": [
        "seed:ACT-002",
        "frontend",
        "filter",
        "mvp"
      ],
      "subtasks": {
        "T-20251113-act-002-frontend-filter-mvp-ST-01": {
          "seed_id": null,
          "title": "实现课程查询 API hook 与缓存",
          "type": "coding",
          "summary": "封装与本地查询 API 的交互，包含分页、条件序列化与 Zustand/React Query 缓存，确保筛选 UI 可复用。",
          "acceptance_draft": [
            "src/api/client.ts 与 src/api/hooks/useCourses.ts 支持 term/campus/filters/pagination，失败自动退避并暴露 loading/error 状态。",
            "实现 src/store/courseFilters.ts 统一管理筛选条件，支持 URL 同步与本地缓存。",
            "新增 hooks 测试（tests/api/useCourses.test.ts）模拟 API 返回值，保证查询参数与响应映射正确。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-008-local-query-api"
          ],
          "blocked": false,
          "blocked_by": [],
          "unblock_plan": "待 API 返回结构确定后搭建 hooks，与前端全局状态联动并提供 storybook/demo 方便调试。",
          "estimate_h": 4,
          "risk": "mid",
          "confidence": 0.62,
          "interfaces_touched": [
            "frontend",
            "api-client"
          ],
          "artifacts": [
            "src/api/client.ts",
            "src/api/hooks/useCourses.ts",
            "src/store/courseFilters.ts",
            "tests/api/useCourses.test.ts"
          ],
          "citations": [
            "EVID-001",
            "EVID-002",
            "EVID-006",
            "R-20251113-frontend-perf",
            "D-20251113-arch-static-frontend-b"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "frontend",
            "state"
          ]
        },
        "T-20251113-act-002-frontend-filter-mvp-ST-02": {
          "seed_id": null,
          "title": "构建多维筛选面板组件",
          "type": "coding",
          "summary": "实现 term/campus/课程属性/时间地点等筛选组件，支持组合、折叠与快捷方式，并与全局状态保持同步。",
          "acceptance_draft": [
            "在 src/components/filters/ 下实现可复用控件（keyword、credits、coreCode、timeRange、weekday、mode、campus 等），具备 aria label 与键盘可访问性。",
            "Storybook 为每个控件提供示例，包含“组合冲突提示”“条件过多折叠”两类交互。",
            "组件与 courseFilters store 双向绑定，修改 UI 即更新状态；增加 tests/components/filters/*.test.tsx 覆盖关键逻辑。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-002-frontend-filter-mvp-ST-01"
          ],
          "blocked": false,
          "blocked_by": [],
          "unblock_plan": "基于字段目录设计 UI，使用 tailwind/ant design 等组件完成响应式布局。",
          "estimate_h": 5,
          "risk": "mid",
          "confidence": 0.58,
          "interfaces_touched": [
            "frontend",
            "ux"
          ],
          "artifacts": [
            "src/components/filters/",
            "stories/filters.stories.tsx",
            "tests/components/filters/"
          ],
          "citations": [
            "EVID-001",
            "EVID-002",
            "EVID-006",
            "R-20251113-frontend-perf",
            "D-20251113-arch-static-frontend-b"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "frontend",
            "ui"
          ]
        },
        "T-20251113-act-002-frontend-filter-mvp-ST-03": {
          "seed_id": null,
          "title": "实现课程结果列表与周历视图",
          "type": "coding",
          "summary": "建立虚拟化结果列表与周视图组件，展示课程详情、Section 与冲突提示，并响应筛选条件变化。",
          "acceptance_draft": [
            "src/pages/CoursesPage.tsx 组合 filters + useCourses hook，列表区域采用 react-window/react-virtualized 处理 ≥10k Sections，保持滚动帧率。",
            "新增 src/components/calendar-view/WeekGrid.tsx 显示 Section 时间块，支持冲突高亮与点击订阅入口。",
            "编写体验测试（tests/pages/courses.test.tsx）模拟多条件筛选与分页跳转，确保 UI 与 API 返回一致。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-002-frontend-filter-mvp-ST-01",
            "T-20251113-act-002-frontend-filter-mvp-ST-02"
          ],
          "blocked": false,
          "blocked_by": [],
          "unblock_plan": "待 hooks 与组件稳定后整合页面，并通过 Chrome Profiler 验证性能达标 (<0.5s)。",
          "estimate_h": 6,
          "risk": "mid",
          "confidence": 0.6,
          "interfaces_touched": [
            "frontend",
            "calendar-view",
            "ux"
          ],
          "artifacts": [
            "src/pages/CoursesPage.tsx",
            "src/components/calendar-view/",
            "tests/pages/courses.test.tsx"
          ],
          "citations": [
            "EVID-001",
            "EVID-002",
            "EVID-006",
            "R-20251113-frontend-perf",
            "D-20251113-arch-static-frontend-b"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "frontend",
            "performance"
          ]
        }
      }
    },
    "T-20251113-act-003-mail-notify-function": {
      "seed_id": "ACT-003",
      "title": "实现课程空位邮件通知功能（本地定时任务）",
      "type": "coding",
      "summary": "依据 D-20251113-notify-channels-email-discord，在每个部署环境中运行本地后台进程定期轮询 SOC openSections，结合本地数据库中的订阅记录判断 Closed→Open 事件，并通过可配置的邮件发送模块通知用户，满足 FR-04/FR-05/FR-06 与 NFR-02 的延迟与可靠性要求。",
      "acceptance_draft": [
        "在本地测试环境模拟 Closed→Open 场景时，记录从状态变化到邮件发送的时间，平均延迟 < 30 秒、最大延迟 < 60 秒，且同一开放事件同一邮箱只收到 1 封邮件。",
        "邮件正文包含课程名称、Index、Section、上课时间地点与订阅人信息，并提供安全的本地退订/管理链接；退订后同一订阅不再收到后续通知。",
        "本地通知进程支持自定义轮询频率、日志与错误重试，能够在网络异常/进程重启后恢复状态，不会静默丢失事件。"
      ],
      "lane": "now",
      "priority_suggested": "P0",
      "status": "todo",
      "dependencies": [
        "T-20251113-act-009-subscription-management",
        "T-20251113-act-010-local-polling-notify",
        "T-20251113-act-011-mail-sender-module"
      ],
      "blocked": true,
      "blocked_by": [
        {
          "dep_id": "DEP-001",
          "name": "Rutgers SOC API（courses.json / openSections）",
          "type": "api",
          "status": "unknown",
          "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
          "note": "接口无正式公开文档，速率限制与长期稳定性未知；若访问策略收紧，将影响通知准确性。"
        },
        {
          "dep_id": "DEP-002",
          "name": "SendGrid 或同类邮件发送服务",
          "type": "api",
          "status": "approved",
          "doc_url": "",
          "note": "免费额度有限且需要正确配置发件域名与内容策略，以降低被判为垃圾邮件的风险。"
        }
      ],
      "unblock_plan": "基于 T-20251113-act-010-local-polling-notify 提供的轮询结果与 T-20251113-act-011-mail-sender-module 中的发送适配器，设计本地 cron/worker，验证多次重试与恢复逻辑后再开放配置。",
      "estimate_h": 8,
      "risk": "high",
      "confidence": 0.65,
      "interfaces_touched": [
        "local-service",
        "notification-service",
        "email-provider",
        "scheduler"
      ],
      "artifacts": [
        "services/notifier/email_worker.ts",
        "templates/email/*",
        "config/email.json"
      ],
      "citations": [
        "EVID-001",
        "EVID-003",
        "EVID-005",
        "R-20251113-notify-delay",
        "R-20251113-spam"
      ],
      "created_at": "2025-11-13T00:00:00Z",
      "updated_at": "2025-11-13T00:00:00Z",
      "owner": "tbd",
      "tags": [
        "seed:ACT-003",
        "backend",
        "email",
        "notification"
      ],
      "subtasks": {
        "T-20251113-act-003-mail-notify-function-ST-01": {
          "seed_id": null,
          "title": "实现订阅驱动的邮件 Worker",
          "type": "coding",
          "summary": "创建 services/notifier/emailWorker.ts，消费轮询产生的 open-seat 事件，整合订阅数据并调用 mail sender 模块。",
          "acceptance_draft": [
            "worker 支持从 db/subscriptions 表分页加载有效订阅，与事件 payload 合并后按用户分组，确保幂等键 (subscriptionId+eventId)。",
            "实现重试与死信策略，使用 SQLite 或文件记录已发送事件，避免重复通知。",
            "tests/notifier/emailWorker.test.ts 使用 jest + sqlite-memory 模拟事件+订阅流，覆盖成功、重试、退订三条路径。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-009-subscription-management",
            "T-20251113-act-010-local-polling-notify",
            "T-20251113-act-011-mail-sender-module"
          ],
          "blocked": true,
          "blocked_by": [
            {
              "dep_id": "DEP-001",
              "name": "Rutgers SOC API（courses.json / openSections）",
              "type": "api",
              "status": "unknown",
              "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
              "note": "接口无正式公开文档，速率限制与长期稳定性未知；若访问策略收紧，将影响通知准确性。"
            },
            {
              "dep_id": "DEP-002",
              "name": "SendGrid 或同类邮件发送服务",
              "type": "api",
              "status": "approved",
              "doc_url": "",
              "note": "免费额度有限且需要正确配置发件域名与内容策略，以降低被判为垃圾邮件的风险。"
            }
          ],
          "unblock_plan": "待订阅模型与轮询事件格式固定后落地 worker，与 mail sender 接口对齐再联调。",
          "estimate_h": 5,
          "risk": "high",
          "confidence": 0.55,
          "interfaces_touched": [
            "notification-service",
            "email-provider",
            "local-service"
          ],
          "artifacts": [
            "services/notifier/emailWorker.ts",
            "services/notifier/__tests__/emailWorker.test.ts",
            "data/notifier/email_dispatched.sqlite"
          ],
          "citations": [
            "EVID-001",
            "EVID-003",
            "EVID-005",
            "R-20251113-notify-delay",
            "R-20251113-spam"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "notification",
            "backend"
          ]
        },
        "T-20251113-act-003-mail-notify-function-ST-02": {
          "seed_id": null,
          "title": "完善邮件模板与渲染管线",
          "type": "coding",
          "summary": "提供 HTML/文本模板、变量渲染与本地预览 CLI，确保邮件包含课程详情与退订入口。",
          "acceptance_draft": [
            "templates/email/open_slot.html/.txt 支持动态插入课程标题、Index、时间地点、退订链接，含中英文文案。",
            "实现 scripts/notify/render_email_preview.ts，可本地渲染指定订阅/事件样例并保存到 tmp/email-preview.html。",
            "文档化模板字段，更新 docs/notify/email_templates.md，包括可见变量与反垃圾提示。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-003-mail-notify-function-ST-01"
          ],
          "blocked": true,
          "blocked_by": [
            {
              "dep_id": "DEP-001",
              "name": "Rutgers SOC API（courses.json / openSections）",
              "type": "api",
              "status": "unknown",
              "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
              "note": "接口无正式公开文档，速率限制与长期稳定性未知；若访问策略收紧，将影响通知准确性。"
            },
            {
              "dep_id": "DEP-002",
              "name": "SendGrid 或同类邮件发送服务",
              "type": "api",
              "status": "approved",
              "doc_url": "",
              "note": "免费额度有限且需要正确配置发件域名与内容策略，以降低被判为垃圾邮件的风险。"
            }
          ],
          "unblock_plan": "与产品确认内容后落地模板，复用前端 i18n 字典以保证文案一致。",
          "estimate_h": 3,
          "risk": "mid",
          "confidence": 0.65,
          "interfaces_touched": [
            "notification-service",
            "i18n",
            "email-provider"
          ],
          "artifacts": [
            "templates/email/open_slot.html",
            "templates/email/open_slot.txt",
            "scripts/notify/render_email_preview.ts",
            "docs/notify/email_templates.md"
          ],
          "citations": [
            "EVID-001",
            "EVID-003",
            "EVID-005",
            "R-20251113-notify-delay",
            "R-20251113-spam"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "email",
            "template"
          ]
        },
        "T-20251113-act-003-mail-notify-function-ST-03": {
          "seed_id": null,
          "title": "搭建端到端通知回归脚本",
          "type": "coding",
          "summary": "使用 fake SMTP + sqlite 搭建 e2e 测试，验证从轮询事件到真实邮件发送的完整链路。",
          "acceptance_draft": [
            "scripts/tests/email_notify_e2e.ts 启动本地 fake SMTP（如 mailhog），触发模拟事件并断言邮件标题/内容/退订链接正确。",
            "CI 中新增 workflow (github actions) 运行 e2e 测试，失败时上传日志与 mailhog 输出。",
            "文档 docs/notify/email_e2e.md 描述如何运行/调试本地端到端测试。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-003-mail-notify-function-ST-01",
            "T-20251113-act-003-mail-notify-function-ST-02"
          ],
          "blocked": true,
          "blocked_by": [
            {
              "dep_id": "DEP-001",
              "name": "Rutgers SOC API（courses.json / openSections）",
              "type": "api",
              "status": "unknown",
              "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
              "note": "接口无正式公开文档，速率限制与长期稳定性未知；若访问策略收紧，将影响通知准确性。"
            },
            {
              "dep_id": "DEP-002",
              "name": "SendGrid 或同类邮件发送服务",
              "type": "api",
              "status": "approved",
              "doc_url": "",
              "note": "免费额度有限且需要正确配置发件域名与内容策略，以降低被判为垃圾邮件的风险。"
            }
          ],
          "unblock_plan": "待 worker 与模板完成后接通 fake SMTP，保证 1 分钟内跑完可供回归。",
          "estimate_h": 4,
          "risk": "mid",
          "confidence": 0.58,
          "interfaces_touched": [
            "notification-service",
            "qa",
            "email-provider"
          ],
          "artifacts": [
            "scripts/tests/email_notify_e2e.ts",
            ".github/workflows/email-e2e.yml",
            "docs/notify/email_e2e.md"
          ],
          "citations": [
            "EVID-001",
            "EVID-003",
            "EVID-005",
            "R-20251113-notify-delay",
            "R-20251113-spam"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "notification",
            "testing"
          ]
        }
      }
    },
    "T-20251113-act-004-discord-notify-channel": {
      "seed_id": "ACT-004",
      "title": "实现 Discord 通知通道并评估私信与频道策略",
      "type": "coding",
      "summary": "在本地通知管道中新增 Discord Bot 通道，运行本地 Bot 客户端将课程开放提醒发送给用户或频道，并结合 Q-04 评估“私信 vs 频道广播”的可行性、噪音与速率限制表现，为默认策略提供依据。",
      "acceptance_draft": [
        "在本地或测试服务器中，Bot 能根据数据库内的订阅记录成功向指定用户或频道发送包含课程名、Index 与时间地点的提醒消息。",
        "实现对 Discord API 速率限制的节流与重试逻辑，本地轮询高频触发时仍保持稳定，不出现长期封禁或严重错误。",
        "文档中记录不同通知模式（私信/频道）的优缺点与推荐默认值，并与产品负责人达成一致。"
      ],
      "lane": "next",
      "priority_suggested": "P2",
      "status": "todo",
      "dependencies": [
        "T-20251113-act-009-subscription-management",
        "T-20251113-act-010-local-polling-notify",
        "T-20251113-act-003-mail-notify-function"
      ],
      "blocked": true,
      "blocked_by": [
        {
          "dep_id": "DEP-001",
          "name": "Rutgers SOC API（courses.json / openSections）",
          "type": "api",
          "status": "unknown",
          "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
          "note": "接口结构与速率限制的不确定性会影响 Discord 通知的触发准确性。"
        },
        {
          "dep_id": "DEP-003",
          "name": "Discord Bot API",
          "type": "api",
          "status": "approved",
          "doc_url": "",
          "note": "受速率限制和内容政策约束，过于频繁或模板化的消息可能被限流或封禁。"
        }
      ],
      "unblock_plan": "在本地环境运行 Bot，复用 T-20251113-act-010-local-polling-notify 的事件推送，结合 Discord Sandbox 逐步提升频率以摸清速率限制，再决定默认通知模式。",
      "estimate_h": 6,
      "risk": "mid",
      "confidence": 0.6,
      "interfaces_touched": [
        "local-service",
        "notification-service",
        "discord-bot"
      ],
      "artifacts": [
        "services/notifier/discord_bot.ts",
        "config/discord.json"
      ],
      "citations": [
        "EVID-001",
        "EVID-004",
        "R-20251113-notify-delay",
        "R-20251113-spam"
      ],
      "created_at": "2025-11-13T00:00:00Z",
      "updated_at": "2025-11-13T00:00:00Z",
      "owner": "tbd",
      "tags": [
        "seed:ACT-004",
        "backend",
        "discord",
        "notification"
      ],
      "subtasks": {
        "T-20251113-act-004-discord-notify-channel-ST-01": {
          "seed_id": null,
          "title": "实现 Discord Bot 客户端",
          "type": "coding",
          "summary": "基于 discord.js/discordeno 实现 Bot 登录、心跳、消息发送与速率控制，封装为 services/notifier/discordBot.ts。",
          "acceptance_draft": [
            "配置 config/discord.json，支持 Bot token、频道 ID、私信模式开关，并通过 dotenv 或 CLI 传参。",
            "服务能处理 sendDirect/sendChannel 两种模式，自动对长消息分页。",
            "tests/notifier/discordBot.test.ts 使用 nock/fixtures 模拟 Discord API，验证速率限制响应与重试逻辑。"
          ],
          "lane": "next",
          "priority_suggested": "P2",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-009-subscription-management",
            "T-20251113-act-010-local-polling-notify"
          ],
          "blocked": true,
          "blocked_by": [
            {
              "dep_id": "DEP-001",
              "name": "Rutgers SOC API（courses.json / openSections）",
              "type": "api",
              "status": "unknown",
              "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
              "note": "接口结构与速率限制的不确定性会影响 Discord 通知的触发准确性。"
            },
            {
              "dep_id": "DEP-003",
              "name": "Discord Bot API",
              "type": "api",
              "status": "approved",
              "doc_url": "",
              "note": "受速率限制和内容政策约束，过于频繁或模板化的消息可能被限流或封禁。"
            }
          ],
          "unblock_plan": "创建测试服务器与频道，先实现最小发送流程再加入速率控制。",
          "estimate_h": 4,
          "risk": "mid",
          "confidence": 0.55,
          "interfaces_touched": [
            "discord-bot",
            "notification-service"
          ],
          "artifacts": [
            "services/notifier/discordBot.ts",
            "config/discord.json",
            "tests/notifier/discordBot.test.ts"
          ],
          "citations": [
            "EVID-001",
            "EVID-004",
            "R-20251113-notify-delay",
            "R-20251113-spam"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "discord",
            "backend"
          ]
        },
        "T-20251113-act-004-discord-notify-channel-ST-02": {
          "seed_id": null,
          "title": "格式化课程消息与订阅映射",
          "type": "coding",
          "summary": "定义 Discord 消息模板、按钮/链接并将订阅/事件映射到相应频道或私信，提供安全校验。",
          "acceptance_draft": [
            "services/notifier/discordPayloads.ts 将课程事件转换为 embed/组件，包含 Index、空位数量、退订链接。",
            "docs/notify/discord_format.md 记录各模式下的字段、速率建议与订阅匹配策略。",
            "新增单元测试覆盖课程字段缺失/异常情况，确保消息 fallback 不崩溃。"
          ],
          "lane": "next",
          "priority_suggested": "P2",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-004-discord-notify-channel-ST-01"
          ],
          "blocked": true,
          "blocked_by": [
            {
              "dep_id": "DEP-001",
              "name": "Rutgers SOC API（courses.json / openSections）",
              "type": "api",
              "status": "unknown",
              "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
              "note": "接口结构与速率限制的不确定性会影响 Discord 通知的触发准确性。"
            },
            {
              "dep_id": "DEP-003",
              "name": "Discord Bot API",
              "type": "api",
              "status": "approved",
              "doc_url": "",
              "note": "受速率限制和内容政策约束，过于频繁或模板化的消息可能被限流或封禁。"
            }
          ],
          "unblock_plan": "与产品讨论消息内容后实现模板，并在测试频道中试发至少 5 个样例。",
          "estimate_h": 3,
          "risk": "mid",
          "confidence": 0.6,
          "interfaces_touched": [
            "discord-bot",
            "notification-service",
            "ux"
          ],
          "artifacts": [
            "services/notifier/discordPayloads.ts",
            "docs/notify/discord_format.md"
          ],
          "citations": [
            "EVID-001",
            "EVID-004",
            "R-20251113-notify-delay",
            "R-20251113-spam"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "discord",
            "template"
          ]
        },
        "T-20251113-act-004-discord-notify-channel-ST-03": {
          "seed_id": null,
          "title": "编写压测与降级 runbook",
          "type": "ops",
          "summary": "提供高频触发下的压测脚本、速率监控以及故障应对手册，确保 Bot 不会被 Discord 封禁。",
          "acceptance_draft": [
            "scripts/tests/discord_rate_limit.ts 可模拟 bursts，记录速率限制 headers 并生成 plots/rate-limit.png。",
            "docs/notify/discord_runbook.md 描述限流、认证失败、频道拒绝等异常的处理步骤，与邮件/Discord 之间的切换策略。",
            "在 README 或 docs 中给出启停/回滚命令，验证 runbook 步骤在测试服务器上可执行。"
          ],
          "lane": "next",
          "priority_suggested": "P2",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-004-discord-notify-channel-ST-01",
            "T-20251113-act-004-discord-notify-channel-ST-02"
          ],
          "blocked": true,
          "blocked_by": [
            {
              "dep_id": "DEP-001",
              "name": "Rutgers SOC API（courses.json / openSections）",
              "type": "api",
              "status": "unknown",
              "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
              "note": "接口结构与速率限制的不确定性会影响 Discord 通知的触发准确性。"
            },
            {
              "dep_id": "DEP-003",
              "name": "Discord Bot API",
              "type": "api",
              "status": "approved",
              "doc_url": "",
              "note": "受速率限制和内容政策约束，过于频繁或模板化的消息可能被限流或封禁。"
            }
          ],
          "unblock_plan": "完成 Bot 与模板后进行压测，并将指标接入简单的日志/图表。",
          "estimate_h": 3,
          "risk": "mid",
          "confidence": 0.58,
          "interfaces_touched": [
            "ops",
            "discord-bot",
            "observability"
          ],
          "artifacts": [
            "scripts/tests/discord_rate_limit.ts",
            "plots/rate-limit.png",
            "docs/notify/discord_runbook.md"
          ],
          "citations": [
            "EVID-001",
            "EVID-004",
            "R-20251113-notify-delay",
            "R-20251113-spam"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "discord",
            "ops"
          ]
        }
      }
    },
    "T-20251113-act-005-frontend-i18n-setup": {
      "seed_id": "ACT-005",
      "title": "搭建前端 i18n 架构并完成中英文界面",
      "type": "coding",
      "summary": "依据决策 D-20251113-multi-lang-day1，在前端引入标准 i18n 库，将所有静态文案（包括错误提示与表单标签）集中到多语言资源文件中，至少完成中英文版本，并为后续小语种支持预留扩展空间。",
      "acceptance_draft": [
        "所有界面文案均通过 i18n 资源文件管理，不再直接硬编码在组件中。",
        "用户可在 UI 中切换中/英文，切换后界面无混合语言或乱码，课程数据本身保留英文但核心代码/字段标签可本地化说明。",
        "构建或 CI 阶段能检测到新增 key 未提供翻译的情况，并给出告警或失败。"
      ],
      "lane": "next",
      "priority_suggested": "P1",
      "status": "todo",
      "dependencies": [
        "T-20251113-act-002-frontend-filter-mvp"
      ],
      "blocked": false,
      "blocked_by": [],
      "unblock_plan": "",
      "estimate_h": 6,
      "risk": "mid",
      "confidence": 0.75,
      "interfaces_touched": [
        "frontend",
        "i18n"
      ],
      "artifacts": [
        "src/i18n/index.ts",
        "locales/en/*.json",
        "locales/zh/*.json"
      ],
      "citations": [
        "EVID-001",
        "EVID-008",
        "R-20251113-i18n-maintenance"
      ],
      "created_at": "2025-11-13T00:00:00Z",
      "updated_at": "2025-11-13T00:00:00Z",
      "owner": "tbd",
      "tags": [
        "seed:ACT-005",
        "frontend",
        "i18n",
        "ux"
      ],
      "subtasks": {
        "T-20251113-act-005-frontend-i18n-setup-ST-01": {
          "seed_id": null,
          "title": "引入 i18n 库与 Provider",
          "type": "coding",
          "summary": "集成 react-i18next（或同类）并在应用入口配置语言切换、资源加载与默认回退。",
          "acceptance_draft": [
            "src/i18n/index.ts 定义 i18n 实例、默认语言与语言探测逻辑，App.tsx 包裹 I18nextProvider。",
            "locales/en/common.json 与 locales/zh/common.json 至少包含导航、筛选、按钮、错误提示等 key。",
            "增加 scripts/i18n/extract.ts 可从源码提取新 key，防止遗漏。"
          ],
          "lane": "next",
          "priority_suggested": "P1",
          "status": "todo",
          "dependencies": [],
          "blocked": false,
          "blocked_by": [],
          "unblock_plan": "选定库后在入口组件挂载 Provider，并为现有页面加上 useTranslation。",
          "estimate_h": 3,
          "risk": "mid",
          "confidence": 0.7,
          "interfaces_touched": [
            "frontend",
            "i18n"
          ],
          "artifacts": [
            "src/i18n/index.ts",
            "src/i18n/config.ts",
            "locales/en/common.json",
            "locales/zh/common.json"
          ],
          "citations": [
            "EVID-001",
            "EVID-008",
            "R-20251113-i18n-maintenance"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "i18n",
            "frontend"
          ]
        },
        "T-20251113-act-005-frontend-i18n-setup-ST-02": {
          "seed_id": null,
          "title": "翻译课程与订阅 UI",
          "type": "coding",
          "summary": "将课程列表、筛选面板、订阅入口等 UI 文案切换到 i18n 字典并补充中英文翻译。",
          "acceptance_draft": [
            "src/pages/CoursesPage.tsx、src/components/filters/*、src/components/subscription/* 不再硬编码中文/英文，全部通过 t('key') 获取。",
            "提供语言切换按钮，切换后保持当前筛选状态不丢失，并含 aria-label。",
            "更新 Cypress/Playwright 用例覆盖中英文切换，确保 UI 不出现 key 泄露。"
          ],
          "lane": "next",
          "priority_suggested": "P1",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-005-frontend-i18n-setup-ST-01"
          ],
          "blocked": false,
          "blocked_by": [],
          "unblock_plan": "在 Provider 生效后，逐个组件替换文案并同步 locales 文件。",
          "estimate_h": 4,
          "risk": "mid",
          "confidence": 0.65,
          "interfaces_touched": [
            "frontend",
            "ux",
            "i18n"
          ],
          "artifacts": [
            "src/pages/CoursesPage.tsx",
            "src/components/filters/",
            "src/components/subscription/",
            "tests/e2e/i18n-switch.spec.ts"
          ],
          "citations": [
            "EVID-001",
            "EVID-008",
            "R-20251113-i18n-maintenance"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "i18n",
            "frontend"
          ]
        },
        "T-20251113-act-005-frontend-i18n-setup-ST-03": {
          "seed_id": null,
          "title": "建立翻译缺失检测与 CI",
          "type": "coding",
          "summary": "实现脚本对比源码与 locale 文件，CI 中自动阻止缺失/未翻译 key，维持多语言质量。",
          "acceptance_draft": [
            "scripts/i18n/check-missing.ts 扫描 src/**/*.{ts,tsx}，提取 t('...') 与 <Trans> key，与 locales/en & zh 做 diff，缺失时报错。",
            "在 package.json 增加 npm run lint:i18n，并在 .github/workflows/lint.yml 中执行。",
            "docs/i18n/maintenance.md 说明新增文案流程与脚本使用方法。"
          ],
          "lane": "next",
          "priority_suggested": "P1",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-005-frontend-i18n-setup-ST-01"
          ],
          "blocked": false,
          "blocked_by": [],
          "unblock_plan": "基于现有 locales 构建 diff 工具，并嵌入 CI。",
          "estimate_h": 2,
          "risk": "low",
          "confidence": 0.75,
          "interfaces_touched": [
            "frontend",
            "ci"
          ],
          "artifacts": [
            "scripts/i18n/check-missing.ts",
            ".github/workflows/lint.yml",
            "docs/i18n/maintenance.md"
          ],
          "citations": [
            "EVID-001",
            "EVID-008",
            "R-20251113-i18n-maintenance"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "i18n",
            "quality"
          ]
        }
      }
    },
    "T-20251113-act-006-deploy-docs-cicd": {
      "seed_id": "ACT-006",
      "title": "编写并验证本地一键部署文档与辅助脚本",
      "type": "docs",
      "summary": "围绕“本地数据库 + 轻量 API 服务 + 前端 UI + 后台通知进程”的架构，整理本地部署步骤与环境要求，编写 README 与辅助脚本，使普通用户在个人电脑或服务器上无需修改代码即可初始化数据库、运行 API/前端/通知服务并完成配置。",
      "acceptance_draft": [
        "README 提供针对至少两种主流桌面操作系统（例如 Windows 与 macOS 或 Linux）的本地部署步骤，包含：安装 Node.js/bun、SQLite 或嵌入式数据库依赖、项目初始化、环境变量与密钥配置、如何执行数据库初始化/增量更新脚本，以及如何同时启动前端、API 服务与本地通知进程。",
        "仓库包含可直接使用的本地辅助脚本（例如 scripts/setup_local_env.sh 和 scripts/run_local.sh），在一台全新环境的个人电脑上，用户 clone 仓库后运行脚本即可完成依赖安装校验、数据库初始化、服务启动与通知模块验证。"
      ],
      "lane": "next",
      "priority_suggested": "P1",
      "status": "todo",
      "dependencies": [
        "T-20251113-act-001-soc-json-scraper",
        "T-20251113-act-002-frontend-filter-mvp",
        "T-20251113-act-003-mail-notify-function",
        "T-20251113-act-008-local-query-api",
        "T-20251113-act-009-subscription-management",
        "T-20251113-act-010-local-polling-notify"
      ],
      "blocked": false,
      "blocked_by": [],
      "unblock_plan": "以本地单机运行与容器部署为一等公民目标设计流程：在至少两种主流桌面环境验证脚本可初始化 SQLite、启动 API/前端/通知服务，再整理成 README。",
      "estimate_h": 6,
      "risk": "mid",
      "confidence": 0.7,
      "interfaces_touched": [
        "docs",
        "local-dev",
        "deployment"
      ],
      "artifacts": [
        "README.md",
        ".env.example",
        "scripts/setup_local_env.sh",
        "scripts/run_local.sh"
      ],
      "citations": [
        "EVID-001",
        "EVID-006",
        "EVID-007",
        "R-20251113-oss-governance"
      ],
      "created_at": "2025-11-13T00:00:00Z",
      "updated_at": "2025-11-13T00:00:00Z",
      "owner": "tbd",
      "tags": [
        "seed:ACT-006",
        "docs",
        "deployment",
        "local-deploy"
      ],
      "subtasks": {
        "T-20251113-act-006-deploy-docs-cicd-ST-01": {
          "seed_id": null,
          "title": "提供可复现的本地依赖安装脚本",
          "type": "coding",
          "summary": "为 Windows、macOS/Linux 编写 setup_local_env 脚本，安装 Node/bun、依赖包、SQLite 并校验版本。",
          "acceptance_draft": [
            "scripts/setup_local_env.sh 与 scripts/setup_local_env.ps1 覆盖两大平台，完成 node/bun 检查、pnpm 安装、npm install。",
            "脚本执行后输出环境摘要（版本、PATH 等），并写入 logs/setup_<timestamp>.txt。",
            "README 增加“运行 setup 脚本”章节，含演示截图或终端输出。"
          ],
          "lane": "next",
          "priority_suggested": "P1",
          "status": "todo",
          "dependencies": [],
          "blocked": false,
          "blocked_by": [],
          "unblock_plan": "调研两平台依赖安装方式，并为 Windows 提供执行策略说明。",
          "estimate_h": 3,
          "risk": "mid",
          "confidence": 0.68,
          "interfaces_touched": [
            "local-dev",
            "ops"
          ],
          "artifacts": [
            "scripts/setup_local_env.sh",
            "scripts/setup_local_env.ps1",
            "logs/setup_*.txt",
            "README.md"
          ],
          "citations": [
            "EVID-001",
            "EVID-006",
            "EVID-007",
            "R-20251113-oss-governance"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "deployment",
            "automation"
          ]
        },
        "T-20251113-act-006-deploy-docs-cicd-ST-02": {
          "seed_id": null,
          "title": "编写一键启动/停止脚本",
          "type": "coding",
          "summary": "通过 docker-compose 或 pm2，提供 run_local.* 脚本拉起 SQLite、API、前端与通知服务，统一注入环境变量。",
          "acceptance_draft": [
            "docker-compose.yml 或 scripts/run_local.sh 负责启动 API、前端、poller、notifier 四个进程，并在 data/ 下挂载 SQLite。",
            "提供 scripts/stop_local.sh 安全停止服务并清理临时容器/进程。",
            "在 docs/deploy/local.md 记录启动后需要打开的端口、验证命令（健康检查、示例 API 调用）。"
          ],
          "lane": "next",
          "priority_suggested": "P1",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-001-soc-json-scraper",
            "T-20251113-act-008-local-query-api",
            "T-20251113-act-010-local-polling-notify"
          ],
          "blocked": false,
          "blocked_by": [],
          "unblock_plan": "待关键服务可独立运行后，用 docker compose/foreman 将其串起来并打通 env。",
          "estimate_h": 4,
          "risk": "mid",
          "confidence": 0.6,
          "interfaces_touched": [
            "deployment",
            "ops",
            "local-dev"
          ],
          "artifacts": [
            "docker-compose.yml",
            "scripts/run_local.sh",
            "scripts/stop_local.sh",
            "docs/deploy/local.md"
          ],
          "citations": [
            "EVID-001",
            "EVID-006",
            "EVID-007",
            "R-20251113-oss-governance"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "deployment",
            "automation"
          ]
        },
        "T-20251113-act-006-deploy-docs-cicd-ST-03": {
          "seed_id": null,
          "title": "撰写部署手册与排障章节",
          "type": "docs",
          "summary": "将成功部署经验整理为 docs/deploy/troubleshooting.md，列出自检步骤、常见报错与处理流程。",
          "acceptance_draft": [
            "docs/deploy/local.md 覆盖前提条件、env 变量、初始化数据库、启动/停止命令。",
            "docs/deploy/troubleshooting.md 列出至少 6 个常见问题（依赖缺失、端口占用、邮件配置、Discord token 等）及排障命令。",
            "README 主页链接这些文档，并附上成功运行截图/日志供用户对比。"
          ],
          "lane": "next",
          "priority_suggested": "P1",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-006-deploy-docs-cicd-ST-01",
            "T-20251113-act-006-deploy-docs-cicd-ST-02"
          ],
          "blocked": false,
          "blocked_by": [],
          "unblock_plan": "在完成脚本后边演练边记录，将问题和解决方案写入文档。",
          "estimate_h": 3,
          "risk": "mid",
          "confidence": 0.7,
          "interfaces_touched": [
            "docs",
            "deployment",
            "support"
          ],
          "artifacts": [
            "docs/deploy/local.md",
            "docs/deploy/troubleshooting.md",
            "README.md"
          ],
          "citations": [
            "EVID-001",
            "EVID-006",
            "EVID-007",
            "R-20251113-oss-governance"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "docs",
            "deployment"
          ]
        }
      }
    },
    "T-20251113-act-007-local-db-schema": {
      "seed_id": "ACT-007",
      "title": "设计本地数据库模式与增量更新机制",
      "type": "coding",
      "summary": "定义 SQLite 等嵌入式数据库中的课程、Section、会议信息与订阅表结构，设计索引与约束，并实现初始化/迁移与增量更新策略，使数据成为筛选与通知的单一可信源。",
      "acceptance_draft": [
        "提供 schema 定义（课程、Section、meeting_times、订阅等表）与必要索引/约束，字段覆盖 FR-01/FR-02/FR-04 所需信息，并附带 ER/说明文档。",
        "实现 scripts/migrate_db.* 可初始化或升级数据库，重复运行不会破坏已有数据；随机抽样记录验证字段与 SOC 返回一致。",
        "定义增量更新策略（例如基于 upsert、事务或临时表交换），在模拟部分课程状态变化的场景下，仅更新发生变化的数据且不中断前端/API 查询。"
      ],
      "lane": "now",
      "priority_suggested": "P0",
      "status": "todo",
      "dependencies": [
        "T-20251113-soc-api-validation"
      ],
      "blocked": true,
      "blocked_by": [
        {
          "dep_id": "DEP-001",
          "name": "Rutgers SOC API（courses.json / openSections）",
          "type": "api",
          "status": "unknown",
          "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
          "note": "接口结构与速率限制需要先通过 T-20251113-soc-api-validation 实测后，才能确定 schema 设计所需字段。"
        }
      ],
      "unblock_plan": "在 T-20251113-soc-api-validation 中确认字段/速率后，设计 schema 与索引并用小样本跑通迁移脚本，再推广到完整数据集。",
      "estimate_h": 8,
      "risk": "mid",
      "confidence": 0.65,
      "interfaces_touched": [
        "database",
        "data-pipeline"
      ],
      "artifacts": [
        "db/schema.sql",
        "scripts/migrate_db.ts",
        "docs/db_schema.md"
      ],
      "citations": [
        "EVID-001",
        "EVID-002",
        "EVID-006",
        "R-20251113-frontend-perf"
      ],
      "created_at": "2025-11-13T00:00:00Z",
      "updated_at": "2025-11-13T00:00:00Z",
      "owner": "tbd",
      "tags": [
        "seed:ACT-007",
        "backend",
        "database",
        "data-pipeline"
      ],
      "subtasks": {
        "T-20251113-act-007-local-db-schema-ST-01": {
          "seed_id": null,
          "title": "输出第一版 schema.sql",
          "type": "coding",
          "summary": "基于 SOC 字段定义 courses、sections、meeting_times、open_sections、subscriptions 等表，提交 db/schema.sql 与解释文档。",
          "acceptance_draft": [
            "db/schema.sql 定义所有表字段、主键、外键及必要索引；字段覆盖 FR-01/FR-02/FR-04 所需信息。",
            "docs/db/schema_explainer.md 描述字段来源与取值范围，并附 ER 图。",
            "提供 tests/db/schema_smoke.test.ts，使用 sqlite-temp 验证 schema 可成功创建。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [
            "T-20251113-soc-api-validation"
          ],
          "blocked": true,
          "blocked_by": [
            {
              "dep_id": "DEP-001",
              "name": "Rutgers SOC API（courses.json / openSections）",
              "type": "api",
              "status": "unknown",
              "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
              "note": "接口结构与速率限制需要先通过 T-20251113-soc-api-validation 实测后，才能确定 schema 设计所需字段。"
            }
          ],
          "unblock_plan": "在 SOC 样本与字段统计明确后提交 schema，并同步 ER 图。",
          "estimate_h": 4,
          "risk": "mid",
          "confidence": 0.6,
          "interfaces_touched": [
            "database",
            "docs"
          ],
          "artifacts": [
            "db/schema.sql",
            "docs/db/schema_explainer.md",
            "tests/db/schema_smoke.test.ts"
          ],
          "citations": [
            "EVID-001",
            "EVID-002",
            "EVID-006",
            "R-20251113-frontend-perf"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "database",
            "design"
          ]
        },
        "T-20251113-act-007-local-db-schema-ST-02": {
          "seed_id": null,
          "title": "实现迁移与回滚脚本",
          "type": "coding",
          "summary": "提供 scripts/migrate_db.ts，可创建/升级/回滚 SQLite，保证重复执行安全。",
          "acceptance_draft": [
            "脚本支持 up/down、--dry-run、--target-version 参数，迁移文件放在 db/migrations/<timestamp>_*.sql。",
            "tests/migrations.test.ts 使用临时数据库执行两次迁移并回滚，确保无脏数据。",
            "package.json 新增 npm run db:migrate / db:reset，README 记录使用示例。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-007-local-db-schema-ST-01"
          ],
          "blocked": true,
          "blocked_by": [
            {
              "dep_id": "DEP-001",
              "name": "Rutgers SOC API（courses.json / openSections）",
              "type": "api",
              "status": "unknown",
              "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
              "note": "接口结构与速率限制需要先通过 T-20251113-soc-api-validation 实测后，才能确定 schema 设计所需字段。"
            }
          ],
          "unblock_plan": "schema 定稿后拆分为迁移文件，封装 CLI 并在 CI 中演练。",
          "estimate_h": 3,
          "risk": "mid",
          "confidence": 0.65,
          "interfaces_touched": [
            "database",
            "build-script"
          ],
          "artifacts": [
            "scripts/migrate_db.ts",
            "db/migrations/",
            "tests/migrations.test.ts"
          ],
          "citations": [
            "EVID-001",
            "EVID-002",
            "EVID-006",
            "R-20251113-frontend-perf"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "database",
            "automation"
          ]
        },
        "T-20251113-act-007-local-db-schema-ST-03": {
          "seed_id": null,
          "title": "提供查询视图与性能基线",
          "type": "coding",
          "summary": "建立课程/Section 展示所需的 materialized views 或索引，并以基准脚本验证查询性能。",
          "acceptance_draft": [
            "db/views/course_search.sql 汇总课程 + Sections + meeting_times，提供筛选所需字段；db/views/open_sections.sql 面向通知。",
            "新增 db/indexes.sql 或内联索引定义，覆盖 term/campus/credits/weekday 等高频过滤字段。",
            "scripts/db/benchmark_queries.ts 执行典型查询并输出 <500ms 的基准结果，附带 docs/db/perf_notes.md。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-007-local-db-schema-ST-01"
          ],
          "blocked": true,
          "blocked_by": [
            {
              "dep_id": "DEP-001",
              "name": "Rutgers SOC API（courses.json / openSections）",
              "type": "api",
              "status": "unknown",
              "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
              "note": "接口结构与速率限制需要先通过 T-20251113-soc-api-validation 实测后，才能确定 schema 设计所需字段。"
            }
          ],
          "unblock_plan": "以 schema 为基础创建视图与索引，结合真实样本跑性能脚本。",
          "estimate_h": 4,
          "risk": "mid",
          "confidence": 0.58,
          "interfaces_touched": [
            "database",
            "performance",
            "docs"
          ],
          "artifacts": [
            "db/views/course_search.sql",
            "db/views/open_sections.sql",
            "db/indexes.sql",
            "scripts/db/benchmark_queries.ts",
            "docs/db/perf_notes.md"
          ],
          "citations": [
            "EVID-001",
            "EVID-002",
            "EVID-006",
            "R-20251113-frontend-perf"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "database",
            "performance"
          ]
        }
      }
    },
    "T-20251113-act-008-local-query-api": {
      "seed_id": "ACT-008",
      "title": "实现本地课程查询 API 服务",
      "type": "coding",
      "summary": "基于 SQLite 数据库实现 RESTful API（如 /api/courses、/api/sections、/api/filters），支持多字段过滤、分页与排序，为前端筛选与订阅面板提供一致的数据访问层。",
      "acceptance_draft": [
        "实现至少 /api/courses 与 /api/sections 两个端点，接受 term/campus/subject/关键字/时间/core_code/level 等查询参数，返回 JSON 包含分页信息，任意组合筛选均能得到与数据库一致的结果。",
        "在 4500+ 课程数据规模下，常见查询（含 3~5 个过滤条件）响应时间 < 300 ms，提供必要索引与缓存并通过压测记录指标。",
        "API 提供错误处理与健康检查端点（例如 /api/health），当前端无法连接时能返回明确错误码与原因，便于 UI 友好提示。"
      ],
      "lane": "now",
      "priority_suggested": "P0",
      "status": "todo",
      "dependencies": [
        "T-20251113-act-007-local-db-schema",
        "T-20251113-act-001-soc-json-scraper"
      ],
      "blocked": false,
      "blocked_by": [],
      "unblock_plan": "复用抓取脚本产出的 SQLite 数据，挑选轻量框架（Express/Fastify/FastAPI 等）实现端点，并通过自动化测试覆盖主要组合筛选。",
      "estimate_h": 8,
      "risk": "mid",
      "confidence": 0.7,
      "interfaces_touched": [
        "backend",
        "api",
        "database"
      ],
      "artifacts": [
        "services/api/server.ts",
        "services/api/routes/courses.ts",
        "tests/api/courses.test.ts"
      ],
      "citations": [
        "EVID-001",
        "EVID-006",
        "R-20251113-frontend-perf"
      ],
      "created_at": "2025-11-13T00:00:00Z",
      "updated_at": "2025-11-13T00:00:00Z",
      "owner": "tbd",
      "tags": [
        "seed:ACT-008",
        "backend",
        "api",
        "database"
      ],
      "subtasks": {
        "T-20251113-act-008-local-query-api-ST-01": {
          "seed_id": null,
          "title": "搭建本地查询 API 服务",
          "type": "coding",
          "summary": "用 Fastify/Express 初始化 services/api，加载 env、日志与健康检查，连接 SQLite。",
          "acceptance_draft": [
            "services/api/server.ts 提供 /healthz、/version 端点，注入 sqlite 池并启用统一错误处理。",
            "config/api.json 管理端口、分页、缓存等默认值，支持 .env 覆盖。",
            "tests/api/health.test.ts 验证服务启动、健康检查、配置加载。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-007-local-db-schema"
          ],
          "blocked": false,
          "blocked_by": [],
          "unblock_plan": "在 schema 就绪后初始化 API 项目结构，与前端约定返回格式。",
          "estimate_h": 3,
          "risk": "mid",
          "confidence": 0.64,
          "interfaces_touched": [
            "api",
            "backend"
          ],
          "artifacts": [
            "services/api/server.ts",
            "services/api/config.ts",
            "tests/api/health.test.ts"
          ],
          "citations": [
            "EVID-001",
            "EVID-006",
            "R-20251113-frontend-perf"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "api",
            "backend"
          ]
        },
        "T-20251113-act-008-local-query-api-ST-02": {
          "seed_id": null,
          "title": "实现课程/Section 查询端点",
          "type": "coding",
          "summary": "根据查询模型实现 /courses 与 /sections 端点，支持多维筛选、排序与分页。",
          "acceptance_draft": [
            "services/api/routes/courses.ts 解析 query 参数（term、campus、credits、weekday、keyword 等）并使用 SQL 视图返回分页结果。",
            "端点返回附带 facets/aggregations 供前端展示，并在响应头写入 X-Total-Count。",
            "tests/api/courses.test.ts 覆盖典型筛选组合以及非法参数校验。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-008-local-query-api-ST-01",
            "T-20251113-act-007-local-db-schema"
          ],
          "blocked": false,
          "blocked_by": [],
          "unblock_plan": "复用 views/indexes 完成查询 SQL，并写单元/集成测试。",
          "estimate_h": 5,
          "risk": "mid",
          "confidence": 0.6,
          "interfaces_touched": [
            "api",
            "database"
          ],
          "artifacts": [
            "services/api/routes/courses.ts",
            "services/api/routes/sections.ts",
            "tests/api/courses.test.ts"
          ],
          "citations": [
            "EVID-001",
            "EVID-006",
            "R-20251113-frontend-perf"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "api",
            "query"
          ]
        },
        "T-20251113-act-008-local-query-api-ST-03": {
          "seed_id": null,
          "title": "加入缓存与批量查询优化",
          "type": "coding",
          "summary": "引入缓存层与批量查询策略，减少重复 SQL 并为前端周视图提供批量数据接口。",
          "acceptance_draft": [
            "services/api/cache/queryCache.ts 支持基于 filter hash 的内存缓存，包含 TTL 与 LRU 机制。",
            "新增 /bulk/sections 或 streaming 端点，针对周视图一次返回指定 Index/Section 列表。",
            "提供 metrics（如 Prometheus exporter）记录查询命中率与耗时，文档化使用方式。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-008-local-query-api-ST-01",
            "T-20251113-act-008-local-query-api-ST-02"
          ],
          "blocked": false,
          "blocked_by": [],
          "unblock_plan": "在基础端点稳定后增加缓存层，并用 benchmark 工具评估收益。",
          "estimate_h": 4,
          "risk": "mid",
          "confidence": 0.55,
          "interfaces_touched": [
            "api",
            "performance",
            "observability"
          ],
          "artifacts": [
            "services/api/cache/queryCache.ts",
            "services/api/routes/bulkSections.ts",
            "tests/api/cache.test.ts",
            "docs/api/perf.md"
          ],
          "citations": [
            "EVID-001",
            "EVID-006",
            "R-20251113-frontend-perf"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "api",
            "performance"
          ]
        }
      }
    },
    "T-20251113-act-009-subscription-management": {
      "seed_id": "ACT-009",
      "title": "实现订阅管理接口与本地存储",
      "type": "coding",
      "summary": "为课程/Section 提供订阅与退订 UI，以及与数据库衔接的 /api/subscribe、/api/unsubscribe 等接口，将用户邮箱/Discord 标识与目标课程索引安全写入本地订阅表。",
      "acceptance_draft": [
        "在课程列表或详情中提供“订阅空位”入口，点击后调用 /api/subscribe 写入数据库，并支持校验输入（邮箱或 Discord 标识）以及重复订阅提示。",
        "实现 /api/unsubscribe（含带签名的退订链接）与订阅列表查询接口，用户可从邮件/Discord 链接或 UI 中退订，数据库记录同步更新。",
        "在本地运行环境中执行一次完整流程（订阅→模拟开放→退订），确认数据库记录、API 响应与通知任务读取到的数据一致。"
      ],
      "lane": "now",
      "priority_suggested": "P0",
      "status": "todo",
      "dependencies": [
        "T-20251113-act-002-frontend-filter-mvp",
        "T-20251113-act-007-local-db-schema",
        "T-20251113-act-008-local-query-api"
      ],
      "blocked": false,
      "blocked_by": [],
      "unblock_plan": "在完成课程列表与 API 基础后，扩展 UI 和接口，编写端到端测试验证订阅/退订流程与数据库同步。",
      "estimate_h": 6,
      "risk": "mid",
      "confidence": 0.7,
      "interfaces_touched": [
        "frontend",
        "api",
        "database",
        "notification-service"
      ],
      "artifacts": [
        "src/components/subscription/*",
        "services/api/routes/subscriptions.ts",
        "db/subscriptions.sql"
      ],
      "citations": [
        "EVID-001",
        "EVID-005",
        "R-20251113-notify-delay"
      ],
      "created_at": "2025-11-13T00:00:00Z",
      "updated_at": "2025-11-13T00:00:00Z",
      "owner": "tbd",
      "tags": [
        "seed:ACT-009",
        "frontend",
        "backend",
        "notification"
      ],
      "subtasks": {
        "T-20251113-act-009-subscription-management-ST-01": {
          "seed_id": null,
          "title": "建订阅表与数据访问层",
          "type": "coding",
          "summary": "创建 subscriptions、subscription_channels、subscription_events 等表，并实现 TS repository。",
          "acceptance_draft": [
            "db/migrations/20251113_create_subscriptions.sql 定义字段（courseId、sectionIndex、email/discord、locale、status、meta）。",
            "services/subscriptions/repository.ts 提供 create/findByStatus/updateStatus 等方法，附带输入校验。",
            "tests/subscriptions/repository.test.ts 使用 sqlite-memory 验证 CRUD 与唯一索引。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-007-local-db-schema"
          ],
          "blocked": false,
          "blocked_by": [],
          "unblock_plan": "基于 schema 扩展订阅相关表并建立 repository，供 API 与 worker 调用。",
          "estimate_h": 4,
          "risk": "mid",
          "confidence": 0.62,
          "interfaces_touched": [
            "database",
            "backend"
          ],
          "artifacts": [
            "db/migrations/20251113_create_subscriptions.sql",
            "services/subscriptions/repository.ts",
            "tests/subscriptions/repository.test.ts"
          ],
          "citations": [
            "EVID-001",
            "EVID-005",
            "R-20251113-notify-delay"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "subscription",
            "database"
          ]
        },
        "T-20251113-act-009-subscription-management-ST-02": {
          "seed_id": null,
          "title": "实现创建/管理/退订 API",
          "type": "coding",
          "summary": "在服务端提供 REST/JSON API 供前端创建订阅、验证邮箱、查询状态与退订。",
          "acceptance_draft": [
            "POST /api/subscriptions 支持 email/discord、term、courseId、index，创建后返回验证 token。",
            "GET /api/subscriptions/<token> 返回状态，DELETE 退订时记录原因并软删除。",
            "tests/api/subscriptions.test.ts 覆盖 happy path、重复创建、token 失效等情况。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-009-subscription-management-ST-01",
            "T-20251113-act-008-local-query-api"
          ],
          "blocked": false,
          "blocked_by": [],
          "unblock_plan": "在 repository 就绪后实现 API，结合邮件/Discord 验证流程。",
          "estimate_h": 4,
          "risk": "mid",
          "confidence": 0.6,
          "interfaces_touched": [
            "api",
            "backend",
            "security"
          ],
          "artifacts": [
            "services/api/routes/subscriptions.ts",
            "tests/api/subscriptions.test.ts",
            "docs/subscription/api.md"
          ],
          "citations": [
            "EVID-001",
            "EVID-005",
            "R-20251113-notify-delay"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "subscription",
            "api"
          ]
        },
        "T-20251113-act-009-subscription-management-ST-03": {
          "seed_id": null,
          "title": "实现自助管理界面",
          "type": "coding",
          "summary": "提供前端页面让用户查看/暂停/删除订阅，并在邮件/Discord 中引用安全链接。",
          "acceptance_draft": [
            "src/pages/Subscriptions/Manage.tsx 根据 token 渲染订阅列表，支持状态切换与 audit log。",
            "加入安全机制：token + HMAC 校验 + 过期时间，防止被猜测。",
            "新增 e2e 测试（tests/e2e/subscription_manage.spec.ts）覆盖创建→邮件链接→退订流程。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-009-subscription-management-ST-02",
            "T-20251113-act-005-frontend-i18n-setup"
          ],
          "blocked": false,
          "blocked_by": [],
          "unblock_plan": "完成 API 后搭建页面，并在模板中嵌入链接进行联调。",
          "estimate_h": 4,
          "risk": "mid",
          "confidence": 0.6,
          "interfaces_touched": [
            "frontend",
            "api",
            "security"
          ],
          "artifacts": [
            "src/pages/Subscriptions/Manage.tsx",
            "tests/e2e/subscription_manage.spec.ts",
            "docs/subscription/manage_ui.md"
          ],
          "citations": [
            "EVID-001",
            "EVID-005",
            "R-20251113-notify-delay"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "subscription",
            "frontend"
          ]
        }
      }
    },
    "T-20251113-act-010-local-polling-notify": {
      "seed_id": "ACT-010",
      "title": "本地空位轮询与通知调度服务",
      "type": "coding",
      "summary": "实现常驻后台任务或定时器，每 30–60 秒轮询 Rutgers openSections 接口，结合本地订阅数据判断课程状态变化，触发事件管道供邮箱/Discord 等通道消费，并处理幂等与错误恢复。",
      "acceptance_draft": [
        "可配置轮询频率与 term/campus 范围，模拟 Section 状态从 Closed→Open 的过程，确认在一个轮询周期内生成事件并写入去重缓存。",
        "同一开放事件最多触发一次通知，短时间内频繁开关的 Section 不会造成重复推送；提供幂等键或状态表来记录已通知事件。",
        "轮询任务具备日志、指标与错误恢复能力（例如网络失败自动重试、进程重启后继续），并可将事件推送到邮箱/Discord 等通道的队列。"
      ],
      "lane": "now",
      "priority_suggested": "P0",
      "status": "todo",
      "dependencies": [
        "T-20251113-act-007-local-db-schema",
        "T-20251113-act-009-subscription-management"
      ],
      "blocked": true,
      "blocked_by": [
        {
          "dep_id": "DEP-001",
          "name": "Rutgers SOC API（courses.json / openSections）",
          "type": "api",
          "status": "unknown",
          "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
          "note": "需要确认 openSections 的速率限制与字段稳定性后才能设定本地轮询与节流策略。"
        }
      ],
      "unblock_plan": "基于 T-20251113-soc-api-validation 成果，选定轮询频率与批量参数，先在小范围 term/campus 上验证事件生成、幂等与日志，再扩展到完整数据集。",
      "estimate_h": 8,
      "risk": "high",
      "confidence": 0.6,
      "interfaces_touched": [
        "local-service",
        "notification-service",
        "scheduler"
      ],
      "artifacts": [
        "services/notifier/poller.ts",
        "services/notifier/event_store.ts",
        "tests/notifier/poller.test.ts"
      ],
      "citations": [
        "EVID-001",
        "EVID-003",
        "R-20251113-notify-delay"
      ],
      "created_at": "2025-11-13T00:00:00Z",
      "updated_at": "2025-11-13T00:00:00Z",
      "owner": "tbd",
      "tags": [
        "seed:ACT-010",
        "backend",
        "notification",
        "scheduler"
      ],
      "subtasks": {
        "T-20251113-act-010-local-polling-notify-ST-01": {
          "seed_id": null,
          "title": "实现轮询 Worker 框架",
          "type": "coding",
          "summary": "在 services/poller 中构建调度器，按配置定期调用 SOC API，将结果写入临时表/缓存。",
          "acceptance_draft": [
            "services/poller/index.ts 支持配置 term/campus 队列、并发度、重试策略，并能在 CLI 中单独启动。",
            "实现持久化游标（data/poller_state.sqlite）记录上次成功时间、最后一个 Section ID。",
            "tests/poller/poller.test.ts 使用 fake SOC API 验证调度顺序与 backoff。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-001-soc-json-scraper",
            "T-20251113-act-007-local-db-schema",
            "T-20251113-soc-api-validation"
          ],
          "blocked": true,
          "blocked_by": [
            {
              "dep_id": "DEP-001",
              "name": "Rutgers SOC API（courses.json / openSections）",
              "type": "api",
              "status": "unknown",
              "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
              "note": "需要确认 openSections 的速率限制与字段稳定性后才能设定本地轮询与节流策略。"
            }
          ],
          "unblock_plan": "待 SOC client 与 schema 准备好后实现 worker，并先跑单一 term 校验。",
          "estimate_h": 5,
          "risk": "high",
          "confidence": 0.53,
          "interfaces_touched": [
            "scheduler",
            "data-source",
            "notification-service"
          ],
          "artifacts": [
            "services/poller/index.ts",
            "services/poller/config.ts",
            "data/poller_state.sqlite",
            "tests/poller/poller.test.ts"
          ],
          "citations": [
            "EVID-001",
            "EVID-003",
            "R-20251113-notify-delay"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "poller",
            "backend"
          ]
        },
        "T-20251113-act-010-local-polling-notify-ST-02": {
          "seed_id": null,
          "title": "实现差异计算与事件队列",
          "type": "coding",
          "summary": "比较最新 openSections 与上次状态，生成开放/关闭事件并推送到邮件/Discord 队列。",
          "acceptance_draft": [
            "services/poller/stateStore.ts 维护上次 openSections 快照，diff 出新增空位、容量变化与 waitlist 开放。",
            "实现 event dispatcher（services/poller/eventDispatcher.ts）将事件写到 data/events/pending.sqlite 或 Redis。",
            "tests/poller/diff.test.ts 覆盖 closed→open、open→closed、重复变化等场景，确保幂等键正确。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-010-local-polling-notify-ST-01"
          ],
          "blocked": true,
          "blocked_by": [
            {
              "dep_id": "DEP-001",
              "name": "Rutgers SOC API（courses.json / openSections）",
              "type": "api",
              "status": "unknown",
              "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
              "note": "需要确认 openSections 的速率限制与字段稳定性后才能设定本地轮询与节流策略。"
            }
          ],
          "unblock_plan": "使用真实 openSections 样本验证 diff 逻辑，并与通知 worker 约定事件格式。",
          "estimate_h": 4,
          "risk": "mid",
          "confidence": 0.58,
          "interfaces_touched": [
            "notification-service",
            "data-pipeline"
          ],
          "artifacts": [
            "services/poller/stateStore.ts",
            "services/poller/eventDispatcher.ts",
            "data/events/",
            "tests/poller/diff.test.ts"
          ],
          "citations": [
            "EVID-001",
            "EVID-003",
            "R-20251113-notify-delay"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "poller",
            "eventing"
          ]
        },
        "T-20251113-act-010-local-polling-notify-ST-03": {
          "seed_id": null,
          "title": "暴露监控与运维工具",
          "type": "coding",
          "summary": "为轮询流程提供 Prometheus 指标、日志聚合与 CLI 观测工具，便于定位延迟问题。",
          "acceptance_draft": [
            "services/poller/metrics.ts 暴露 scrape_duration_seconds、events_emitted_total、backoff_count 等指标，支持 Prometheus 拉取。",
            "scripts/ops/poller_watch.ts 可实时查看当前批次、剩余队列与最近错误。",
            "docs/notify/poller_monitoring.md 记录如何接入 metrics、何时触发告警。"
          ],
          "lane": "now",
          "priority_suggested": "P0",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-010-local-polling-notify-ST-01",
            "T-20251113-act-010-local-polling-notify-ST-02"
          ],
          "blocked": true,
          "blocked_by": [
            {
              "dep_id": "DEP-001",
              "name": "Rutgers SOC API（courses.json / openSections）",
              "type": "api",
              "status": "unknown",
              "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
              "note": "需要确认 openSections 的速率限制与字段稳定性后才能设定本地轮询与节流策略。"
            }
          ],
          "unblock_plan": "在 worker/diff 稳定后接入 metrics，并编写运维脚本与文档。",
          "estimate_h": 3,
          "risk": "mid",
          "confidence": 0.6,
          "interfaces_touched": [
            "observability",
            "ops",
            "notification-service"
          ],
          "artifacts": [
            "services/poller/metrics.ts",
            "scripts/ops/poller_watch.ts",
            "docs/notify/poller_monitoring.md"
          ],
          "citations": [
            "EVID-001",
            "EVID-003",
            "R-20251113-notify-delay"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "poller",
            "observability"
          ]
        }
      }
    },
    "T-20251113-act-011-mail-sender-module": {
      "seed_id": "ACT-011",
      "title": "邮件发送模块多平台支持",
      "type": "coding",
      "summary": "抽象邮件发送接口并提供至少 SendGrid API 与 SMTP 两种实现，允许通过配置切换，同时支持多语言模板、速率限制与失败重试，以方便不同部署者使用自有邮件服务。",
      "acceptance_draft": [
        "提供统一的 MailSender 接口与配置（API key、SMTP host、发件人等），可在不改代码的情况下切换 SendGrid 与 SMTP，实现都能发送测试邮件。",
        "邮件内容模板支持中英文版本，可注入课程名、Index、订阅者信息等变量；模板缺少翻译或字段时能在构建/测试阶段捕获。",
        "在模拟配额用尽或网络错误时，模块能降级重试或记录清晰错误日志，不会导致主进程崩溃。"
      ],
      "lane": "next",
      "priority_suggested": "P1",
      "status": "todo",
      "dependencies": [
        "T-20251113-act-009-subscription-management"
      ],
      "blocked": false,
      "blocked_by": [],
      "unblock_plan": "在完成订阅存储后，先实现 SendGrid 版本，再扩展 SMTP/本地邮件发送，并接入邮件模板与单元测试。",
      "estimate_h": 5,
      "risk": "mid",
      "confidence": 0.7,
      "interfaces_touched": [
        "notification-service",
        "email-provider",
        "i18n"
      ],
      "artifacts": [
        "services/notify/mail_sender.ts",
        "config/email.example.json",
        "templates/email/*"
      ],
      "citations": [
        "EVID-001",
        "EVID-005",
        "R-20251113-spam"
      ],
      "created_at": "2025-11-13T00:00:00Z",
      "updated_at": "2025-11-13T00:00:00Z",
      "owner": "tbd",
      "tags": [
        "seed:ACT-011",
        "backend",
        "email",
        "notification"
      ],
      "subtasks": {
        "T-20251113-act-011-mail-sender-module-ST-01": {
          "seed_id": null,
          "title": "定义统一 MailMessage/Result 类型",
          "type": "coding",
          "summary": "实现 services/notify/mail/types.ts，描述消息字段、模板变量与发送结果枚举，并附带校验工具。",
          "acceptance_draft": [
            "定义 MailMessage/MailRecipient/MailResult 等类型，支持 locale、templateId、variables、metadata。",
            "提供 helper functions（validateMailMessage）确保缺失字段会报错。",
            "tests/mail/types.test.ts 覆盖必填字段校验与序列化逻辑。"
          ],
          "lane": "next",
          "priority_suggested": "P1",
          "status": "todo",
          "dependencies": [],
          "blocked": false,
          "blocked_by": [],
          "unblock_plan": "梳理通知系统所需字段后定义统一类型，并纳入 tsconfig path。",
          "estimate_h": 2,
          "risk": "low",
          "confidence": 0.75,
          "interfaces_touched": [
            "notification-service",
            "email-provider"
          ],
          "artifacts": [
            "services/notify/mail/types.ts",
            "tests/mail/types.test.ts",
            "docs/notify/mail_sender_interface.md"
          ],
          "citations": [
            "EVID-001",
            "EVID-005",
            "R-20251113-spam"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "email",
            "design"
          ]
        },
        "T-20251113-act-011-mail-sender-module-ST-02": {
          "seed_id": null,
          "title": "实现 SendGrid 与 SMTP 适配器",
          "type": "coding",
          "summary": "根据统一接口实现 sendgrid 与 SMTP 两个 provider，并通过配置控制启用/降级。",
          "acceptance_draft": [
            "services/notify/mail/providers/sendgrid.ts 封装官方 SDK，支持模板渲染、API key 与重试；提供 metrics。",
            "services/notify/mail/providers/smtp.ts 使用 nodemailer/SMTP 发送，支持本地 mailhog。",
            "tests/mail/providers.test.ts 模拟发送成功/失败，确认 fallback 策略可触发。"
          ],
          "lane": "next",
          "priority_suggested": "P1",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-011-mail-sender-module-ST-01"
          ],
          "blocked": false,
          "blocked_by": [],
          "unblock_plan": "定义接口后分别实现 provider，并通过 env 选择默认渠道。",
          "estimate_h": 4,
          "risk": "mid",
          "confidence": 0.62,
          "interfaces_touched": [
            "email-provider",
            "ops"
          ],
          "artifacts": [
            "services/notify/mail/providers/sendgrid.ts",
            "services/notify/mail/providers/smtp.ts",
            "tests/mail/providers.test.ts",
            "config/mail.json"
          ],
          "citations": [
            "EVID-001",
            "EVID-005",
            "R-20251113-spam"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "email",
            "integration"
          ]
        },
        "T-20251113-act-011-mail-sender-module-ST-03": {
          "seed_id": null,
          "title": "实现调度与降级控制器",
          "type": "coding",
          "summary": "创建 mail dispatcher，支持优先级队列、速率限制、失败降级与仪表盘输出。",
          "acceptance_draft": [
            "services/notify/mail/dispatcher.ts 维护队列与 worker，按优先级输出发送请求，并在失败后切换备用 provider。",
            "记录 metrics（send_success_total、send_fail_total、queue_size 等）并暴露到 Prometheus。",
            "docs/notify/mail_failover.md 描述配置项、阈值与运行监控，附本地演练流程。"
          ],
          "lane": "next",
          "priority_suggested": "P1",
          "status": "todo",
          "dependencies": [
            "T-20251113-act-011-mail-sender-module-ST-02"
          ],
          "blocked": false,
          "blocked_by": [],
          "unblock_plan": "provider 完成后实现 dispatcher，并与通知 worker 联调验证降级路径。",
          "estimate_h": 4,
          "risk": "mid",
          "confidence": 0.58,
          "interfaces_touched": [
            "notification-service",
            "email-provider",
            "observability"
          ],
          "artifacts": [
            "services/notify/mail/dispatcher.ts",
            "services/notify/mail/metrics.ts",
            "docs/notify/mail_failover.md"
          ],
          "citations": [
            "EVID-001",
            "EVID-005",
            "R-20251113-spam"
          ],
          "created_at": "2025-11-13T00:00:00Z",
          "updated_at": "2025-11-13T00:00:00Z",
          "owner": "tbd",
          "tags": [
            "subtask",
            "email",
            "reliability"
          ]
        }
      }
    }
  },
  "questions_for_human": [
    "Q-01：SOC 抓取范围——是否存在官方推荐的一次性抓取全校课程的参数组合（如 subject=ALL），还是必须按院系/subject 逐个请求？如果只能逐个请求，你能接受的完整抓取时长和抓取频率上限是什么？",
    "Q-02：课程基础信息的更新频率——静态课程信息（标题、描述、学分等）每日一次更新是否足够，还是需要在选课高峰期临时提高到每小时/每数小时一次？",
    "Q-03：空位订阅策略——当课程在满员/有空位之间频繁切换时，是只在首次开放时发送一次通知并自动删除订阅，还是每次开放都发送，或允许用户在界面中自定义策略？",
    "Q-04：Discord 通知形态——更偏向 Bot 私信（更即时但可能更易触发限流）还是频道广播（噪音更大但更稳），以及是否已有规划好的服务器/频道用于测试与正式使用？",
    "Q-05：周历“框选时间找课”的语义——你更希望框选的是“上课时间完全落在选中时间段内的课程”，还是“与该时间段不冲突的所有可选课程”？该功能期望在 MVP、v1.1 还是 v2.0 交付？",
    "Q-06：具体覆盖范围——在“需要同时支持多个学期、多校区以及本科/研究生课程”的前提下，MVP 期望最少覆盖哪些 term（例如当前学期 + 下一学期）以及哪些校区组合，以便规划数据抓取批量任务和前端筛选维度？"
  ],
  "assumptions": [
    "假设 Rutgers SOC 公开接口在 2025–2026 学年仍保持可匿名访问，且字段结构与调研时基本一致。",
    "假设 MVP 阶段需要同时覆盖多个学期、多个校区以及本科和研究生课程，主要用户群体为 Rutgers 各校区的在读学生（含本科与研究生）。",
    "假设目标用户可以接受通过邮箱或 Discord 接收课程空位通知，不强依赖短信等其他通知渠道。",
    "假设无需用户登录即可通过带签名的退订链接完成订阅管理，用户能够理解并接受这种轻量级身份验证方式。"
  ],
  "risks": [
    {
      "id": "R-20251113-soc-api-change",
      "summary": "Rutgers SOC API 结构或访问策略变更、速率限制收紧，导致课程数据抓取失败或不完整。",
      "severity": "high",
      "mitigation": "封装独立的数据访问层，增加结构版本检测与失败重试；对调用错误设置监控与告警；预备基于 HTML 页面解析的备选抓取方式，并控制抓取频率以避免触发限流。",
      "citations": [
        "EVID-001",
        "EVID-002"
      ]
    },
    {
      "id": "R-20251113-notify-delay",
      "summary": "课程状态变化与用户收到通知之间的延迟过长，或出现漏报/重复通知，削弱“狙击空位”的价值。",
      "severity": "high",
      "mitigation": "合理设置轮询周期（例如 30–60 秒），优先使用 openSections 等批量接口；在通知管道中实现幂等处理；为关键任务配置心跳与告警，并通过长期测试收集延迟分布与失败率。",
      "citations": [
        "EVID-001",
        "EVID-003",
        "EVID-005"
      ]
    },
    {
      "id": "R-20251113-frontend-perf",
      "summary": "在低端设备或数据量增大时，前端渲染与筛选性能不足，导致明显卡顿或响应超时。",
      "severity": "mid",
      "mitigation": "使用虚拟列表、分页与延迟渲染减少 DOM 压力；优化筛选算法（尽量 O(n) 扫描、必要时排序）；必要时引入 Web Worker 或 WASM，并通过性能脚本持续监控。",
      "citations": [
        "EVID-001",
        "EVID-006"
      ]
    },
    {
      "id": "R-20251113-spam",
      "summary": "邮件或 Discord 消息被用户或平台判定为垃圾信息，导致送达率下降甚至账号/应用被封禁。",
      "severity": "mid",
      "mitigation": "使用成熟邮件服务并正确配置发件域名；控制通知频率与内容个性化；在邮件中提供清晰退订入口与订阅说明；为 Discord Bot 设置速率限制与重试策略，必要时采用频道摘要替代大量私信。",
      "citations": [
        "EVID-001",
        "EVID-003",
        "EVID-004",
        "EVID-005"
      ]
    },
    {
      "id": "R-20251113-i18n-maintenance",
      "summary": "多语言内容维护滞后，新功能上线时部分语言缺失翻译或内容不一致，影响非英文用户体验。",
      "severity": "mid",
      "mitigation": "所有界面文案统一走 i18n 资源文件；在 CI 中加入缺失翻译检查；对未翻译 key 统一回退英文并标记 TODO，定期清理。",
      "citations": [
        "EVID-001",
        "EVID-008"
      ]
    },
    {
      "id": "R-20251113-oss-governance",
      "summary": "开源仓库缺乏持续维护，Issue/PR 堆积或依赖安全漏洞得不到修复，削弱社区信任。",
      "severity": "mid",
      "mitigation": "制定贡献指南与代码规范；配置依赖安全扫描与自动升级工具；鼓励社区维护者参与协作，并在 README 中明确官方维护范围与责任边界。",
      "citations": [
        "EVID-001"
      ]
    }
  ],
  "external_dependencies": [
    {
      "dep_id": "DEP-001",
      "name": "Rutgers SOC API（courses.json / openSections）",
      "type": "api",
      "status": "unknown",
      "doc_url": "https://github.com/anxious-engineer/Rutgers-Course-API",
      "note": "接口无正式公开文档，速率限制与长期稳定性未知；任何结构或访问策略变更都会影响数据抓取与通知准确性。"
    },
    {
      "dep_id": "DEP-002",
      "name": "SendGrid 或同类邮件发送服务",
      "type": "api",
      "status": "approved",
      "doc_url": "",
      "note": "免费额度有限，若用户规模增长可能超限；需要正确配置发件域名与发送策略以降低被判为垃圾邮件的风险。"
    },
    {
      "dep_id": "DEP-003",
      "name": "Discord Bot API",
      "type": "api",
      "status": "approved",
      "doc_url": "",
      "note": "受速率限制和内容政策约束，过于频繁或模板化的消息可能被限流或封禁。"
    },
    {
      "dep_id": "DEP-004",
      "name": "本地运行环境/容器（Node.js + SQLite + 定时任务）",
      "type": "tool",
      "status": "approved",
      "doc_url": "",
      "note": "每个部署实例需要具备运行 Node.js 服务、SQLite 数据库与后台定时任务的能力，可通过本地运行或容器化实现；不再依赖纯静态托管平台。"
    }
  ],
  "facts": [
    "本 JSON 基于 2025-11-11-dr 研究结论整理，数据源为 Rutgers SOC 与相关开源/社区资料。:contentReference[oaicite:0]{index=0}",
    "项目目标是在“浏览筛选课程 + 订阅空位提醒”场景下替代 CSP 和 WebReg 的日常使用体验，而不是替代官方 WebReg 的选课注册流程。",
    "系统统一使用 Rutgers SOC 公开接口（courses.json、openSections 等）作为课程与容量数据来源，不抓取需要登录的 WebReg 页面。",
    "架构采用“本地 SQLite 数据库 + 轻量 API 服务 + 前端 SPA + 本地后台通知”的组合，各部署实例独立运行数据库与通知进程，避免浏览器一次性加载几十 MB JSON。",
    "通知渠道 MVP 聚焦邮箱和 Discord，并通过显式退订/管理入口满足隐私与反垃圾邮件规范。",
    "项目从 day-1 起按多语言架构设计，至少支持中英文 UI，并通过 i18n 资源文件管理文案以方便后续扩展其他语言。"
  ],
  "decisions": [
    {
      "id": "D-20251113-arch-static-frontend-b",
      "summary": "v1.x 阶段采用“本地 SQLite 数据库 + 轻量 API 服务 + 前端 SPA”的一体化架构，而不是继续依赖纯静态前端加载大 JSON 与云函数通知。",
      "rationale": "courses.json 体积已达 20–40 MB，纯前端加载造成性能、带宽与更新成本过高；将数据落地到本地 SQLite，并由轻量 API/后台任务统一负责筛选与通知，可以增量更新、降低前端负担，并保持每个部署实例独立运行。",
      "citations": [
        "EVID-001",
        "EVID-006",
        "R-20251113-frontend-perf",
        "R-20251113-notify-delay"
      ],
      "date": "2025-11-13T00:00:00Z"
    },
    {
      "id": "D-20251113-data-source-soc",
      "summary": "课程与空位数据统一使用 Rutgers SOC 公开接口（courses.json / openSections 等），禁止抓取 WebReg 或需要登录的页面。",
      "rationale": "SOC 提供官方公开的课程与容量数据，是合法且稳定的主要来源；避免抓取需要登录的 WebReg 页面，可以减少合规和技术风险。",
      "citations": [
        "EVID-001",
        "EVID-002"
      ],
      "date": "2025-11-13T00:00:00Z"
    },
    {
      "id": "D-20251113-client-side-filter",
      "summary": "课程筛选与排序主要由嵌入式数据库与本地查询 API 承担，前端仅负责构建条件并展示结果，不再预加载全量数据。",
      "rationale": "在多学期/多校区场景下数据量动辄数千课程，浏览器内存筛选难以兼顾性能与增量更新；利用 SQLite 索引与 API 分页可以维持 <0.5 秒响应并复用同一份数据给通知管道。",
      "citations": [
        "EVID-001",
        "EVID-006",
        "R-20251113-frontend-perf"
      ],
      "date": "2025-11-13T00:00:00Z"
    },
    {
      "id": "D-20251113-notify-channels-email-discord",
      "summary": "通知渠道优先支持邮箱和 Discord，短信等其他渠道暂不在 MVP 范围内。",
      "rationale": "邮件和 Discord 在 Rutgers 学生群体中使用广泛、成本可控且生态成熟；短信成本高且合规复杂，因此在满足 MVP 的前提下优先实现邮箱与 Discord。",
      "citations": [
        "EVID-001",
        "EVID-003",
        "EVID-004",
        "EVID-005"
      ],
      "date": "2025-11-13T00:00:00Z"
    },
    {
      "id": "D-20251113-multi-lang-day1",
      "summary": "项目从 day-1 起按多语言架构设计，至少支持中英文 UI，通过标准 i18n 库管理所有文案。",
      "rationale": "多语言需求在项目初期已被明确，及早引入 i18n 能避免后续大规模重构，同时方便支持小语种学生群体。",
      "citations": [
        "EVID-001",
        "EVID-008"
      ],
      "date": "2025-11-13T00:00:00Z"
    },
    {
      "id": "D-20251113-coverage-multi-term-campus",
      "summary": "MVP 阶段即支持多学期、多校区以及本科/研究生课程的联合浏览与筛选，不以单一校区本科课程为起点。",
      "rationale": "真实选课场景中，学生往往需要在不同学期与不同校区的本科/研究生课程之间做整体规划；从一开始按多维度覆盖设计数据抓取与前端筛选，可以避免后续为扩展范围进行架构级重构。",
      "citations": [
        "EVID-001",
        "Q-06"
      ],
      "date": "2025-11-13T00:00:00Z"
    }
  ]
}
